<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appliance Load Calculator (kW & kWh)</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
            padding: 10px;
        }
		footer { margin-top: 18px; text-align: right; font-size: 13px; color: #94a3b8; }
        
        .container {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            max-width: 1200px;
            margin: 0 auto;
        }
        
        @media (min-width: 768px) {
            .container {
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 25px;
                padding: 25px;
            }
        }
        
        .main-content {
            width: 100%;
        }
        
        .side-note {
            width: 100%;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: clamp(1.5rem, 4vw, 2rem);
        }
        
        h2 {
            color: #2c3e50;
            text-align: center;
            margin: 20px 0 15px 0;
            font-size: clamp(1.2rem, 3vw, 1.5rem);
        }
        
        .description {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        @media (min-width: 480px) {
            .input-group {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .input-group input {
                flex: 1;
                min-width: 0;
            }
        }
        
        .input-group input {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .quantity-input {
            width: 80px;
            text-align: center;
        }
        
        .input-group button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            flex: 1;
        }
        
        @media (min-width: 480px) {
            .input-group button {
                flex: 0 1 auto;
            }
        }
        
        button {
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        #addBtn:hover {
            background: #2980b9;
        }
        
        #resetBtn {
            background: #e74c3c;
            width: 100%;
            padding: 12px;
            margin: 5px 0;
        }
        
        #resetBtn:hover {
            background: #c0392b;
        }
        
        #reportBtn {
            background: #27ae60;
            width: 100%;
            padding: 12px;
            margin: 5px 0;
        }
        
        #reportBtn:hover {
            background: #219653;
        }
        
        .remove-btn {
            background: #e74c3c;
            padding: 6px 12px;
            font-size: 14px;
            border-radius: 4px;
            border: none;
            color: white;
            cursor: pointer;
        }
        
        .remove-btn:hover {
            background: #c0392b;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            -webkit-overflow-scrolling: touch;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        
        th, td {
            padding: 12px 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .total-section {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        .total-section p {
            font-size: clamp(1rem, 2.5vw, 1.2em);
            margin: 10px 0;
        }
        
        .kwh {
            color: #27ae60;
            font-weight: bold;
        }
        
        .kw {
            color: #e67e22;
            font-weight: bold;
        }
        
        .empty-message {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 30px 20px;
        }
        
        .actions-cell {
            width: 90px;
            text-align: center;
        }
        
        .quantity-cell {
            width: 80px;
            text-align: center;
        }
        
        .wattage-note {
            background: #e8f4fd;
            border: 1px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .wattage-note h3 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: clamp(1rem, 2.5vw, 1.1em);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .wattage-note h3::before {
            content: "💡";
        }
        
        .wattage-list {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        
        .wattage-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 10px;
            border-bottom: 1px dashed #bdc3c7;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 5px;
        }
        
        .wattage-item:hover {
            background: #d6eaf8;
            transform: translateX(5px);
        }
        
        .wattage-item:active {
            background: #aed6f1;
            transform: translateX(2px);
        }
        
        .wattage-item.selected {
            background: #3498db;
            color: white;
        }
        
        .wattage-item.selected .appliance-name,
        .wattage-item.selected .wattage-value {
            color: white;
        }
        
        .appliance-name {
            color: #2c3e50;
            font-size: clamp(0.8rem, 2vw, 0.9em);
            font-weight: 500;
        }
        
        .wattage-value {
            color: #e67e22;
            font-weight: bold;
            font-size: clamp(0.8rem, 2vw, 0.9em);
        }
        
        .note-text {
            font-size: clamp(0.75rem, 2vw, 0.8em);
            color: #7f8c8d;
            margin-top: 10px;
            font-style: italic;
            line-height: 1.4;
        }
        
        /* Report Modal */
        .report-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .report-content {
            background: white;
            margin: 20px auto;
            padding: 30px;
            border-radius: 10px;
            max-width: 800px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 15px;
        }
        
        .report-section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .report-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .report-section h3::before {
            content: "📊";
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .close-btn:hover {
            background: #c0392b;
        }
        
        .print-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
            width: 100%;
        }
        
        .print-btn:hover {
            background: #2980b9;
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .report-table th,
        .report-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        .report-table th {
            background: #3498db;
            color: white;
        }
        
        .report-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .cost-estimate {
            background: #e8f6f3;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 15px 0;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        
        @media (max-width: 767px) {
            .container {
                padding: 15px;
            }
            
            .report-content {
                margin: 10px;
                padding: 20px;
            }
            
            .input-group input {
                margin-bottom: 8px;
            }
            
            th, td {
                padding: 10px 8px;
            }
            
            .wattage-note {
                padding: 15px;
            }
            
            .total-section {
                padding: 15px;
            }
            
            .wattage-item {
                padding: 10px 8px;
            }
            
            .quantity-input {
                width: 70px;
            }
        }
        
        @media (max-width: 360px) {
            .container {
                padding: 10px;
            }
            
            th, td {
                padding: 8px 6px;
                font-size: 0.8rem;
            }
            
            .input-group input,
            .input-group button {
                padding: 10px;
            }
            
            .wattage-item {
                padding: 8px 6px;
            }
            
            .quantity-input {
                width: 60px;
            }
        }
        
        @media (min-width: 1200px) {
            body {
                padding: 20px;
            }
        }
        
        @media print {
            .report-modal {
                display: block !important;
                position: static;
                background: white;
            }
            
            .report-content {
                box-shadow: none;
                margin: 0;
            }
            
            .close-btn,
            .print-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <h1>🏠 Appliance Load Calculator</h1>
			<h2>Macksons Solar</h2>
            <p class="description">Enter your appliances to calculate total power (kW) and energy consumption (kWh).</p>

            <div class="input-group">
                <input type="text" id="applianceName" placeholder="Appliance Name" required>
                <input type="number" id="applianceWatts" placeholder="Power (Watts)" min="1" required>
                <input type="number" id="applianceQuantity" class="quantity-input" placeholder="Qty" min="1" value="1" required>
                <input type="number" id="applianceHours" placeholder="Hours/Day" min="0" step="0.1" required>
                <button id="addBtn">Add & Calculate</button>
            </div>

            <div class="table-container">
                <table id="applianceTable">
                    <thead>
                        <tr>
                            <th>Appliance</th>
                            <th>Power (W)</th>
                            <th class="quantity-cell">Qty</th>
                            <th>Hours/Day</th>
                            <th>kWh/day</th>
                            <th class="actions-cell">Action</th>
                        </tr>
                    </thead>
                    <tbody id="applianceList">
                        <tr id="emptyRow">
                            <td colspan="6" class="empty-message">No appliances added yet. Start by adding one above.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button id="reportBtn">📊 Generate Energy Report</button>
            <button id="resetBtn">🗑️ Reset Entire List</button>

            <div class="total-section">
                <h2>Total Load</h2>
                <p>Total Power: <span id="totalKW" class="kw">0</span> kW</p>
                <p>Total Energy: <span id="totalKWH" class="kwh">0</span> kWh/day</p>
                <p>Estimated Monthly Energy: <span id="totalKWHMonth" class="kwh">0</span> kWh/month</p>
            </div>
        </div>

        <!-- Side Note for Wattage Reference -->
        <div class="side-note">
            <div class="wattage-note">
                <h3>Quick Wattage Reference</h3>
                <p class="note-text" style="margin-bottom: 15px;">Click on any appliance to auto-fill the form</p>
                
                <div class="wattage-list">
                    <div class="wattage-item" data-name="LED Bulb" data-watts="12">
                        <span class="appliance-name">LED Bulb</span>
                        <span class="wattage-value">12W</span>
                    </div>
                    <div class="wattage-item" data-name="CFL Bulb" data-watts="20">
                        <span class="appliance-name">CFL Bulb</span>
                        <span class="wattage-value">20W</span>
                    </div>
                    <div class="wattage-item" data-name="Ceiling Fan" data-watts="70">
                        <span class="appliance-name">Ceiling Fan</span>
                        <span class="wattage-value">70W</span>
                    </div>
                    <div class="wattage-item" data-name="Table Fan" data-watts="50">
                        <span class="appliance-name">Table Fan</span>
                        <span class="wattage-value">50W</span>
                    </div>
                    <div class="wattage-item" data-name="TV (32–55")" data-watts="100">
                        <span class="appliance-name">TV (32–55")</span>
                        <span class="wattage-value">100W</span>
                    </div>
                    <div class="wattage-item" data-name="Home Theatre" data-watts="200">
                        <span class="appliance-name">Home Theatre</span>
                        <span class="wattage-value">200W</span>
                    </div>
                    <div class="wattage-item" data-name="Refrigerator" data-watts="200">
                        <span class="appliance-name">Refrigerator (32")</span>
                        <span class="wattage-value">200W</span>
                    </div>
                    <div class="wattage-item" data-name="Air Fryer" data-watts="1500">
                        <span class="appliance-name">Air Fryer</span>
                        <span class="wattage-value">1500W</span>
                    </div>
                    <div class="wattage-item" data-name="Freezer" data-watts="250">
                        <span class="appliance-name">Freezer</span>
                        <span class="wattage-value">250W</span>
                    </div>
                    <div class="wattage-item" data-name="Washing Machine (motor only)" data-watts="400">
                        <span class="appliance-name">Washing Machine (motor only)</span>
                        <span class="wattage-value">400W</span>
                    </div>
                    <div class="wattage-item" data-name="Washing Machine (with heater)" data-watts="1800">
                        <span class="appliance-name">Washing Machine (with heater)</span>
                        <span class="wattage-value">1800W</span>
                    </div>
                    <div class="wattage-item" data-name="Microwave Oven" data-watts="1200">
                        <span class="appliance-name">Microwave Oven</span>
                        <span class="wattage-value">1200W</span>
                    </div>
                    <div class="wattage-item" data-name="Rice Cooker" data-watts="500">
                        <span class="appliance-name">Rice Cooker)</span>
                        <span class="wattage-value">500W</span>
                    </div>
                    <div class="wattage-item" data-name="Electric Kettle" data-watts="1500">
                        <span class="appliance-name">Electric Kettle</span>
                        <span class="wattage-value">1500W</span>
                    </div>
                    <div class="wattage-item" data-name="Toaster" data-watts="1000">
                        <span class="appliance-name">Toaster</span>
                        <span class="wattage-value">1000W</span>
                    </div>
                    <div class="wattage-item" data-name="Blender / Mixer" data-watts="500">
                        <span class="appliance-name">Blender / Mixer</span>
                        <span class="wattage-value">500W</span>
                    </div>
                    <div class="wattage-item" data-name="Laptop Charger" data-watts="60">
                        <span class="appliance-name">Laptop Charger</span>
                        <span class="wattage-value">60W</span>
                    </div>
                    <div class="wattage-item" data-name="Mobile Phone Charger" data-watts="20">
                        <span class="appliance-name">Mobile Phone Charger</span>
                        <span class="wattage-value">20W</span>
                    </div>
					<div class="wattage-item" data-name="AC 9,000 BTU" data-watts="1000">
                        <span class="appliance-name">AC 9,000 BTU</span>
                        <span class="wattage-value">1000W</span>
                    </div>
					<div class="wattage-item" data-name="AC 12,000 BTU" data-watts="1350">
                        <span class="appliance-name">AC 12,000 BTU</span>
                        <span class="wattage-value">1350W</span>
                    </div>
					<div class="wattage-item" data-name="AC 18,000 BTU" data-watts="2200">
                        <span class="appliance-name">AC 18,000 BTU</span>
                        <span class="wattage-value">2200W</span>
                    </div>
					<div class="wattage-item" data-name="AC 24,000 BTU" data-watts="3000">
                        <span class="appliance-name">AC 24,000 BTU</span>
                        <span class="wattage-value">3000W</span>
                    </div>
					<div class="wattage-item" data-name="AC 36,000 BTU" data-watts="3500">
                        <span class="appliance-name">AC 36,000 BTU</span>
                        <span class="wattage-value">3500W</span>
                    </div>
					<div class="wattage-item" data-name="Instant Water Heater" data-watts="4000">
                        <span class="appliance-name">Instant Water Heater</span>
                        <span class="wattage-value">4000W</span>
                    </div>
					<div class="wattage-item" data-name="Clothes Iron" data-watts="1500">
                        <span class="appliance-name">Clothes Iron</span>
                        <span class="wattage-value">1500W</span>
                    </div>
					<div class="wattage-item" data-name="DVR / NVR" data-watts="30">
                        <span class="appliance-name">DVR / NVR</span>
                        <span class="wattage-value">30W</span>
                    </div>
					<div class="wattage-item" data-name="CCTV Camera" data-watts="10">
                        <span class="appliance-name">CCTV Camera</span>
                        <span class="wattage-value">10W</span>
                    </div>
					<div class="wattage-item" data-name="Pressure Pump (1 kW)" data-watts="1000">
                        <span class="appliance-name">Pressure Pump (1 kW)</span>
                        <span class="wattage-value">1000W</span>
                    </div>
					<div class="wattage-item" data-name="Water Pump 0.5–1 HP" data-watts="500">
                        <span class="appliance-name">Water Pump 0.5–1 HP</span>
                        <span class="wattage-value">500W</span>
                    </div>
					<div class="wattage-item" data-name="Water Pump 1.5–2 HP" data-watts="1300">
                        <span class="appliance-name">Water Pump 1.5–2 HP</span>
                        <span class="wattage-value">1300W</span>
                    </div>
					<div class="wattage-item" data-name="Large Pump 3 HP+" data-watts="3500">
                        <span class="appliance-name">Large Pump 3 HP+</span>
                        <span class="wattage-value">3500W</span>
                    </div>
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px;">
                    <p style="font-size: 0.8em; margin: 0; color: #856404;">
                        <strong>Tip:</strong> Click any appliance above to auto-fill the form, then set quantity, hours and click "Add & Calculate"
                    </p>
                </div>
            </div>
        </div>
		<footer>Created by Milan Methnuwan</footer>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="report-modal">
        <div class="report-content">
            <button class="close-btn" id="closeReport">×</button>
            
            <div class="report-header">
                <h2>📊 Energy Consumption Report</h2>
                <p>Generated on: <span id="reportDate"></span></p>
            </div>

            <div class="report-section">
                <h3>Summary Overview</h3>
                <div class="highlight">
                    <p><strong>Total Appliances:</strong> <span id="reportApplianceCount">0</span> items</p>
                    <p><strong>Total Quantity:</strong> <span id="reportTotalQuantity">0</span> units</p>
                    <p><strong>Peak Power Demand:</strong> <span id="reportTotalKW">0</span> kW</p>
                    <p><strong>Daily Energy Consumption:</strong> <span id="reportTotalKWH">0</span> kWh</p>
                    <p><strong>Monthly Energy Consumption:</strong> <span id="reportTotalKWHMonth">0</span> kWh</p>
                </div>
            </div>

            <div class="report-section">
                <h3>Appliance Breakdown</h3>
                <table class="report-table" id="reportApplianceTable">
                    <thead>
                        <tr>
                            <th>Appliance</th>
                            <th>Power (W)</th>
                            <th>Qty</th>
                            <th>Hours/Day</th>
                            <th>Daily kWh</th>
                            <th>Monthly kWh</th>
                        </tr>
                    </thead>
                    <tbody id="reportApplianceList">
                        <!-- Filled by JavaScript -->
                    </tbody>
                </table>
            </div>

            <div class="report-section">
                <h3>Cost Estimation</h3>
                <div class="cost-estimate">
                    <p><strong>Enter your electricity rate:</strong></p>
                    <input type="number" id="electricityRate" placeholder="Cost per kWh (e.g., 0.15)" step="0.01" min="0" style="padding: 8px; width: 200px; margin: 10px 0;">
                    <button onclick="calculateCost()" style="padding: 8px 15px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;">Calculate Cost</button>
                    
                    <div id="costResults" style="margin-top: 15px;">
                        <!-- Cost results will appear here -->
                    </div>
                </div>
            </div>

            <div class="report-section">
                <h3>Energy Insights</h3>
                <div id="energyInsights">
                    <!-- Insights will be generated here -->
                </div>
            </div>

            <button class="print-btn" onclick="window.print()">🖨️ Print Report</button>
        </div>
    </div>

    <script>
        // Get DOM elements
        const applianceNameInput = document.getElementById('applianceName');
        const applianceWattsInput = document.getElementById('applianceWatts');
        const applianceQuantityInput = document.getElementById('applianceQuantity');
        const applianceHoursInput = document.getElementById('applianceHours');
        const addButton = document.getElementById('addBtn');
        const resetButton = document.getElementById('resetBtn');
        const reportButton = document.getElementById('reportBtn');
        const closeReportButton = document.getElementById('closeReport');
        const reportModal = document.getElementById('reportModal');
        const applianceList = document.getElementById('applianceList');
        const emptyRow = document.getElementById('emptyRow');
        const totalKWSpan = document.getElementById('totalKW');
        const totalKWHSpan = document.getElementById('totalKWH');
        const totalKWHMonthSpan = document.getElementById('totalKWHMonth');

        // Initialize totals
        let totalWatts = 0;
        let totalWattHours = 0;
        let totalQuantity = 0;
        let appliances = [];
        let selectedAppliance = null;

        // Function to auto-fill form when appliance is clicked
        function setupApplianceClickEvents() {
            const wattageItems = document.querySelectorAll('.wattage-item');
            
            wattageItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove selected class from all items
                    wattageItems.forEach(i => i.classList.remove('selected'));
                    
                    // Add selected class to clicked item
                    this.classList.add('selected');
                    
                    // Get appliance data
                    const name = this.getAttribute('data-name');
                    const watts = this.getAttribute('data-watts');
                    
                    // Auto-fill the form
                    applianceNameInput.value = name;
                    applianceWattsInput.value = watts;
                    applianceQuantityInput.value = '1'; // Default to 1
                    applianceHoursInput.value = ''; // Clear hours for user input
                    
                    // Store selected appliance
                    selectedAppliance = { name, watts: parseInt(watts) };
                    
                    // Focus on hours input for quick entry
                    applianceHoursInput.focus();
                });
            });
        }

        // Function to update the total display
        function updateTotals() {
            const totalKW = totalWatts / 1000;
            const totalKWH = totalWattHours / 1000;
            const totalKWHMonth = totalKWH * 30;

            totalKWSpan.textContent = totalKW.toFixed(2);
            totalKWHSpan.textContent = totalKWH.toFixed(2);
            totalKWHMonthSpan.textContent = totalKWHMonth.toFixed(2);
        }

        // Function to remove an appliance from the list
        function removeAppliance(button) {
            const row = button.closest('tr');
            const index = Array.from(applianceList.children).indexOf(row) - 1;
            
            if (index >= 0) {
                const removedAppliance = appliances[index];
                totalWatts -= removedAppliance.totalWatts;
                totalWattHours -= removedAppliance.totalWattHours;
                totalQuantity -= removedAppliance.quantity;
                appliances.splice(index, 1);
            }
            
            row.remove();
            updateTotals();
            
            if (applianceList.children.length === 0) {
                applianceList.appendChild(emptyRow);
            }
        }

        // Function to add a new appliance to the list and calculate
        function addAppliance() {
            const name = applianceNameInput.value.trim();
            const watts = parseInt(applianceWattsInput.value);
            const quantity = parseInt(applianceQuantityInput.value);
            const hours = parseFloat(applianceHoursInput.value);

            if (name === "" || isNaN(watts) || isNaN(quantity) || isNaN(hours)) {
                alert("Please fill in all fields with valid numbers.");
                return;
            }

            if (quantity < 1) {
                alert("Quantity must be at least 1.");
                return;
            }

            if (emptyRow.parentElement) {
                emptyRow.remove();
            }

            // Calculate totals considering quantity
            const totalApplianceWatts = watts * quantity;
            const totalApplianceWattHours = totalApplianceWatts * hours;
            
            totalWatts += totalApplianceWatts;
            totalWattHours += totalApplianceWattHours;
            totalQuantity += quantity;

            const appliance = { 
                name, 
                watts, 
                quantity, 
                hours, 
                totalWatts: totalApplianceWatts,
                totalWattHours: totalApplianceWattHours
            };
            appliances.push(appliance);

            const newRow = document.createElement('tr');
            const kWh = totalApplianceWattHours / 1000;
            newRow.innerHTML = `
                <td>${name}</td>
                <td>${watts} W</td>
                <td class="quantity-cell">${quantity}</td>
                <td>${hours}</td>
                <td>${kWh.toFixed(2)}</td>
                <td class="actions-cell">
                    <button class="remove-btn" title="Remove this appliance">× Remove</button>
                </td>
            `;
            applianceList.appendChild(newRow);

            newRow.querySelector('.remove-btn').addEventListener('click', function() {
                removeAppliance(this);
            });

            updateTotals();
            
            // Clear form and reset selection
            applianceNameInput.value = '';
            applianceWattsInput.value = '';
            applianceQuantityInput.value = '1';
            applianceHoursInput.value = '';
            selectedAppliance = null;
            
            // Remove selected class from all wattage items
            document.querySelectorAll('.wattage-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            applianceNameInput.focus();
        }

        // Function to generate report
        function generateReport() {
            if (appliances.length === 0) {
                alert("Please add some appliances first to generate a report.");
                return;
            }

            // Update report date
            document.getElementById('reportDate').textContent = new Date().toLocaleDateString();
            
            // Update summary
            document.getElementById('reportApplianceCount').textContent = appliances.length;
            document.getElementById('reportTotalQuantity').textContent = totalQuantity;
            document.getElementById('reportTotalKW').textContent = (totalWatts / 1000).toFixed(2) + ' kW';
            document.getElementById('reportTotalKWH').textContent = (totalWattHours / 1000).toFixed(2) + ' kWh';
            document.getElementById('reportTotalKWHMonth').textContent = (totalWattHours / 1000 * 30).toFixed(2) + ' kWh';

            // Update appliance table
            const reportApplianceList = document.getElementById('reportApplianceList');
            reportApplianceList.innerHTML = '';
            
            appliances.forEach(appliance => {
                const row = document.createElement('tr');
                const dailyKwh = (appliance.totalWattHours / 1000).toFixed(2);
                const monthlyKwh = (dailyKwh * 30).toFixed(2);
                row.innerHTML = `
                    <td>${appliance.name}</td>
                    <td>${appliance.watts} W</td>
                    <td>${appliance.quantity}</td>
                    <td>${appliance.hours}</td>
                    <td>${dailyKwh}</td>
                    <td>${monthlyKwh}</td>
                `;
                reportApplianceList.appendChild(row);
            });

            // Generate insights
            generateInsights();

            // Show modal
            reportModal.style.display = 'block';
        }

        // Function to generate energy insights
        function generateInsights() {
            const insightsDiv = document.getElementById('energyInsights');
            insightsDiv.innerHTML = '';

            const totalMonthlyKwh = (totalWattHours / 1000 * 30);
            const highestConsumer = appliances.reduce((max, app) => 
                (app.totalWattHours) > (max.totalWattHours) ? app : max
            );

            let insights = [
                `Your highest energy-consuming appliance is <strong>${highestConsumer.name}</strong> (${highestConsumer.quantity} units), using ${(highestConsumer.totalWattHours / 1000 * 30).toFixed(2)} kWh per month.`,
                `Total monthly consumption: <strong>${totalMonthlyKwh.toFixed(2)} kWh</strong>`,
                `Total appliances: <strong>${appliances.length}</strong> types, <strong>${totalQuantity}</strong> units in total`,
                `This is equivalent to powering ${Math.round(totalMonthlyKwh / 10)} LED bulbs (12W each) for 8 hours daily for a month.`
            ];

            if (totalMonthlyKwh > 300) {
                insights.push("💡 <strong>Tip:</strong> Consider using energy-efficient appliances to reduce your electricity bill.");
            }

            if (appliances.some(app => app.hours > 16)) {
                insights.push("⏰ <strong>Note:</strong> Some appliances are used for long hours. Consider if they can be optimized.");
            }

            // Check for multiple items of the same type
            const multipleItems = appliances.filter(app => app.quantity > 1);
            if (multipleItems.length > 0) {
                insights.push("🔢 <strong>Multiple Items:</strong> You have multiple units of " + 
                    multipleItems.map(app => `${app.name} (${app.quantity})`).join(', '));
            }

            insights.forEach(insight => {
                const p = document.createElement('p');
                p.innerHTML = insight;
                p.style.margin = '8px 0';
                insightsDiv.appendChild(p);
            });
        }

        // Function to calculate cost
        function calculateCost() {
            const rate = parseFloat(document.getElementById('electricityRate').value);
            if (isNaN(rate) || rate <= 0) {
                alert("Please enter a valid electricity rate.");
                return;
            }

            const dailyKwh = totalWattHours / 1000;
            const monthlyKwh = dailyKwh * 30;
            const yearlyKwh = dailyKwh * 365;

            const dailyCost = dailyKwh * rate;
            const monthlyCost = monthlyKwh * rate;
            const yearlyCost = yearlyKwh * rate;

            const costResults = document.getElementById('costResults');
            costResults.innerHTML = `
                <div style="background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #27ae60;">
                    <p><strong>Daily Cost:</strong> $${dailyCost.toFixed(2)}</p>
                    <p><strong>Monthly Cost:</strong> $${monthlyCost.toFixed(2)}</p>
                    <p><strong>Yearly Cost:</strong> $${yearlyCost.toFixed(2)}</p>
                </div>
            `;
        }

        // Function to reset the entire list
        function resetList() {
            if (confirm("Are you sure you want to clear the entire list?")) {
                applianceList.innerHTML = '';
                applianceList.appendChild(emptyRow);
                totalWatts = 0;
                totalWattHours = 0;
                totalQuantity = 0;
                appliances = [];
                selectedAppliance = null;
                updateTotals();
                
                // Remove selected class from all wattage items
                document.querySelectorAll('.wattage-item').forEach(item => {
                    item.classList.remove('selected');
                });
            }
        }

        // Initialize click events for appliances
        setupApplianceClickEvents();

        // Event Listeners
        addButton.addEventListener('click', addAppliance);
        resetButton.addEventListener('click', resetList);
        reportButton.addEventListener('click', generateReport);
        closeReportButton.addEventListener('click', () => reportModal.style.display = 'none');

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === reportModal) {
                reportModal.style.display = 'none';
            }
        });

        // Enter key support
        [applianceNameInput, applianceWattsInput, applianceQuantityInput, applianceHoursInput].forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addAppliance();
            });
        });

        // Focus on the first input when page loads
        applianceNameInput.focus();
    </script>
</body>
</html>